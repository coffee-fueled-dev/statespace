{
  "schema": {
    "towers": [
      { "name": "A", "disks": [] },
      { "name": "B", "disks": [] },
      { "name": "C", "disks": [] }
    ]
  },
  "transitionRules": [
    {
      "name": "Move disk from one tower to another",
      "constraints": [
        {
          "phase": "pre",
          "type": "compare",
          "path": "sourceTower.disks.length",
          "require": { "type": "greaterThan", "require": [0] }
        },
        {
          "phase": "pre",
          "type": "compare",
          "path": "destinationTower.disks.length",
          "require": { "type": "equals", "require": 0 }
        },
        {
          "phase": "pre",
          "type": "compare",
          "path": "sourceTower.disks[-1]",
          "require": {
            "type": "lessThan",
            "require": [
              {
                "type": "if",
                "require": {
                  "type": "greaterThan",
                  "require": [
                    { "type": "size", "require": "destinationTower.disks" },
                    0
                  ]
                },
                "then": {
                  "type": "get",
                  "require": "destinationTower.disks[-1]"
                },
                "else": { "type": "constant", "require": 4 }
              }
            ]
          }
        }
      ],
      "effects": [
        { "operation": "remove", "path": "sourceTower.disks[-1]" },
        {
          "operation": "add",
          "path": "destinationTower.disks",
          "value": { "type": "get", "require": "sourceTower.disks[-1]" }
        }
      ],
      "cost": 1
    }
  ]
}
